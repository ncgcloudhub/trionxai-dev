(function($){$(document).ready(function(){function b(c){if(c.files&&c.files[0]){var b=new FileReader();b.onload=function(b){$('.inputprev').attr('src',b.target.result);};b.readAsDataURL(c.files[0]);}}
$('#featured-image').change(function(){b(this);});tinyMCE.init({selector:'div.tinymce',theme:'inlite',insert_toolbar:'quicktable blockquote',selection_toolbar:'bold italic | quicklink h2 h3 blockquote',inline:!0,paste_data_images:!1,});$('#king_post_tags').tagsInput({defaultText:'enter tags',height:'auto',width:'100%',maxChars:100,placeholderColor:'#a8b6c0',});$('#king_posts_form').on('submit',function(){var b=$(this).find('#submit-loading');var c=$(this).find('#submit-loading2');b.button('loading');c.button('loading');});$(document).on('change','.poll-radio input[type=radio]',function(){$(this).parents().eq(5).attr('id',this.value);});$(document).on('change','[data-key="field_60afcaf36c797"] .acf-input input',function(e){e.preventDefault();var target=$(this);var checked=target.prop('checked');if(!checked){return;}
var parent=target.parents().eq(6);var id=target.prop('id');var key=target.closest('.acf-field').attr('data-key');var list=parent.find('[data-key="'+key+'"] .acf-input input').not('[data-key="'+key+'"] input[type="hidden"]').not('.acf-clone [data-key="'+key+'"] input');if(list.length==1){return;}
for(var i=0;i<list.length;i++){var item_id=list[i].getAttribute('id');if(id!=item_id){list[i].checked=false;}}});$('#ai-submit').on('click',(event)=>{event.preventDefault();const input=document.getElementById("ai-box");const{value}=input;const{value:selectElement}=document.getElementById("ai-select");const results=document.getElementById("ai-results");if(!value.trim()){return;}
const submit=event.currentTarget;submit.disabled=true;input.disabled=true;submit.classList.add("loading");$.ajax({type:'POST',url:mainscript.ajaxurl,dataType:'json',data:{action:'king_ai_writer',input:value,select:selectElement},success:(response)=>{if(response.success){const sresult=response.data;if(selectElement==='image'){const images=sresult.map(({url})=>`<div class="ai-imgs"><img src="${url}"width="200"height="200"/><div id="king-aimg"data-aimg="${url}"></div></div>`);results.style.display='flex';results.innerHTML+=images.join('');input.disabled=false;submit.disabled=false;submit.classList.remove("loading");}else{const chatBox=document.querySelector("#king_post_content p");let index=0;const typingInterval=setInterval(()=>{const char=sresult.charAt(index);const element=char==='\n'?"<br>":char;chatBox.insertAdjacentHTML('beforebegin',element);index++;if(index>=sresult.length){clearInterval(typingInterval);input.disabled=false;submit.disabled=false;submit.classList.remove("loading");}},20);}}else{console.log(response.data);results.innerHTML+=response.data;input.disabled=false;submit.disabled=false;submit.classList.remove("loading");}}});});$(document).on('click','#king-aimg',(event)=>{const iurl=event.target.dataset.aimg;if(!iurl){return;}
event.target.classList.add("loading");console.log("asdasd"+iurl);$.ajax({type:'POST',url:mainscript.ajaxurl,data:{action:'king_ai_upload',iurl:iurl},success:(response)=>{console.log(response);event.target.classList.add("ldone");event.target.classList.remove("loading");delete event.target.dataset.aimg;},error:(xhr,status,error)=>{console.error(error);}});});});})(jQuery);